

Steps in ATAC-seq analysis

Note: This is just an example with proposed software and algorithms. It is supposed to help you understand the idea behind ATAC-seq analysis and highlight the tricky parts. Nevertheless, it is highly propable that other software or solutions are avaliable that will better fit your data or your user preferences. 

/ My advice - choose the software that agrees with you - but most important don't use software that has very poor documentation and you cannot understand what it does exactly. This is a common mistake of people using a software for, let's say motif search, because on the box it says it looks for the motifs. /

	1. **Reads processing** - quality assessment, filtering and trimming if necessary. *fastqc with multiqc, trim-galore/cutadapt*
	2. **Alignment** *bowtie/bwa mem*
	3. **Aignment processing**
		3.1. quality filtering *picard / samtools*
		3.2. filtering out blacklisted regions *bedtools*
		3.3. shifting alignemnts +4,-5 bp *awk*
	4. Peak calling *macs2 / homer*
	5. Motif search *homer / meme-suite* and footprinting *centipede



	https://github.com/taoliu/MACS/issues/145

BSgenome.Mmusculus.UCSC.mm10


samtools view -h -b -F 3844 -f 2 -q 5 $f | 
# 		samtools sort -n -T ${nam}_tmp -o ${nam}.bed -@ 16;


mapped reads - more than 80%, preferable more than 95%
Non-Redundant Fraction > 0.9
Read length
Library type: PE
ENCODE standard: at least 25 mln non-duplicate, non-mitochondrial aligned fragments

https://www.youtube.com/watch?v=XYZHMGUGq6o