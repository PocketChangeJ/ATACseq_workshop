# ATACseq workshop

Katarzyna Kedzierska
September 16, 2017
Jachranka, Poland

## Table of Content

## Data 

We will be working on data from

> Buenrostro, J. D., Giresi, P. G., Zaba, L. C., Chang, H. Y., & Greenleaf, W. J. (2013). Transposition of native chromatin for fast and sensitive epigenomic profiling of open chromatin, DNA-binding proteins and nucleosome position. Nature Methods, 10(12), 1213–1218. https://doi.org/10.1038/nmeth.2688



## Alignment

 >Data were collected using either 34 × 8 × 34 reads from a MiSeq or 50 × 8 × 50 reads on a HiSeq. Reads were aligned to hg19 using Bowtie36 with the parameters -X2000 and -m1.


Steps in ATAC-seq analysis

Note: This is just an example with proposed software and algorithms. It is supposed to help you understand the idea behind ATAC-seq analysis and highlight the tricky parts. Nevertheless, it is highly propable that other software or solutions are avaliable that will better fit your data or your user preferences. 

/ My advice - choose the software that agrees with you - but most important don't use software that has very poor documentation and you cannot understand what it does exactly. This is a common mistake of people using a software for, let's say motif search, because on the box it says it looks for the motifs. /

	1. **Reads processing** - quality assessment, filtering and trimming if necessary. *fastqc with multiqc, trim-galore/cutadapt*
	2. **Alignment** *bowtie/bwa mem*
	3. **Aignment processing**
		3.1. quality filtering *picard / samtools*
		3.2. filtering out blacklisted regions *bedtools*
		3.3. shifting alignemnts +4,-5 bp *awk*
	4. Peak calling *macs2 / homer*
	5. Motif search *homer / meme-suite* and footprinting *centipede



	https://github.com/taoliu/MACS/issues/145

BSgenome.Mmusculus.UCSC.mm10


samtools view -h -b -F 3844 -f 2 -q 5 $f | 
# 		samtools sort -n -T ${nam}_tmp -o ${nam}.bed -@ 16;



https://www.youtube.com/watch?v=XYZHMGUGq6o

SRR891280 GSM1155969: CD4+_ATACseq_Day3_Rep2; Homo sapiens; OTHER
$ fastq-dump <reads.sra> -Z | bowtie2 -x hg19 -t -p 8 -q -U - -S <output.sam>